<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@latest/dist/echarts.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/alpinejs"></script> -->
    <link rel="stylesheet" href="../src/css/style.css" />

    <!-- <script src="https://fastly.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script> -->

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.2/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@alpinejs/persist"></script>
    <title>Live Dashboard</title>
  </head>

  <body
    x-data="{ page: 'profile', 'loaded': true, 'darkMode': true, 'stickyMenu': false, 'sidebarToggle': false, 'scrollTop': false }"
    x-init="
          darkMode = JSON.parse(localStorage.getItem('darkMode'));
          $watch('darkMode', value => localStorage.setItem('darkMode', JSON.stringify(value)))"
    :class="{'dark text-bodydark bg-boxdark-2': darkMode === true}"
  >
    <!-- ===== Preloader Start ===== -->
    <include src="./partials/preloader.html"></include>
    <!-- ===== Preloader End ===== -->

    <!-- ===== Page Wrapper Start ===== -->
    <div class="flex h-screen overflow-hidden">
      <!-- ===== Sidebar Start ===== -->
      <include src="./partials/sidebar.html"></include>
      <!-- ===== Sidebar End ===== -->

      <!-- ===== Content Area Start ===== -->
      <div
        class="relative flex flex-1 flex-col overflow-y-auto overflow-x-hidden"
      >
        <!-- ===== Header Start ===== -->
        <include src="./partials/header.html" />
        <!-- ===== Header End ===== -->

        <!-- ===== Main Content Start ===== -->
        <main class="align-center flex w-full flex-col">
          <!-- <div class="w-full">
            <h1 class="pl-3 py-4 text-2xl font-semibold bg-gray-700">Navbar</h1>
          </div> -->
          <div class="flex h-full w-full">
            <!-- first -->
            <div class="flex w-[40%] flex-col">
              <!-- <h1 class="text-white ml-4 mt-4 font-black text-5xl">Logs</h1> -->
              <div
                class="border-gray-700 ml-4 mt-4 w-[85%] rounded-md border p-4 text-center dark:bg-meta-4"
              >
                <p class="text-white">
                  <span class="font-bold">Server :</span> Server ABC
                </p>
              </div>
              <div
                class="border-gray-700 ml-4 mt-4 w-[85%] content-center rounded-md border p-4 text-center dark:bg-meta-4"
              >
                <div
                  id="statusIndicator"
                  class="border-gray-700 bg-red-500 ml-[20%] mt-2 w-[60%] justify-center rounded-xl border p-2 text-center"
                >
                  <p id="statusText" class="py-[20%] text-2xl font-black">
                    OFF
                  </p>
                </div>
                <p class="text-white">Last Online : 06-Dec-2023 16:05</p>
                <div class="mt-[10%] ml-[20%] flex">
                  <div
                    class="border-gray-200 flex w-[30%] flex-col items-center rounded-md border py-5"
                  >
                    <p class="text-white">Requests</p>
                    <h1
                      id="requestCount"
                      class="text-green-500 text-4xl font-[1100]"
                    >
                      2000
                    </h1>
                  </div>
                  <div
                    class="border-gray-200 ml-5 flex w-[30%] flex-col items-center rounded-md border py-5"
                  >
                    <p class="text-white">Dummy</p>
                  </div>
                </div>
              </div>
              <!-- <div class="dark:bg-meta-4 p-4 ml-4 mt-4 border border-gray-700 w-[85%] rounded-md text-center content-center">
                    <p class="text-white">Contents</p>
                  </div> -->
              <div
                class="border-gray-700 my-4 ml-4 w-[85%] content-center rounded-md border p-4 text-center dark:bg-meta-4"
              >
                <p class="py-2 text-white">
                  <span class="font-bold">Ip :</span> 192.168.12.13
                </p>
                <p class="py-2 text-white">
                  <span class="font-bold">MAC Address :</span>
                </p>
                <p class="py-2 text-white">
                  <span class="font-bold">Location : </span>
                </p>
                <p class="py-2 text-white">
                  <span class="font-bold">Temperature : </span>
                </p>
              </div>
            </div>
            <!-- second top -->
            <div class="flex w-[60%] flex-col">
              <!-- <div class="flex"> -->
              <!-- status indicator -->

              <!-- graph -->
              <div
                class="mt-5 mr-5"
                id="chart-container"
                style="width: 100%; height: 350px"
              ></div>
              <!-- third -->
              <!-- <div class="w-[60%] float-right ">
                      
                    </div> -->
              <!-- </div>  -->
              <div class="my-10 mr-10">
                <p class="font-bold text-white">Summary</p>
                <div
                  class="border-gray-700 w[30%] h-[200px] rounded-xl border bg-gradient-to-r from-[#0F1A29] to-[#0E2E4E] p-10"
                >
                  <div
                    id="myDiv"
                    x-data="{ fetchedData: null }"
                    x-text="fetchedData ? JSON.stringify(fetchedData) : 'No data fetched'"
                  ></div>
                </div>
              </div>
            </div>
          </div>
          <!-- log table -->
          <div class="bg-indigo-500 h-[60%]">
            <p class="ml-4 mt-4 text-5xl font-black text-white">Log table</p>

            <!--  -->
            <!-- Search Functionality -->
            <div class="mt-4 flex bg-black text-black">
              <label for="searchColumn" class="mr-2">Search By:</label>
              <select
                id="searchColumn"
                class="border-gray-700 bg-indigo-500 border p-2"
              >
                <option class="text-red" value="search">Drop Down</option>
                <option class="text-red" value="all">All</option>
                <option class="text-red" value="log_id">Log ID</option>
                <option value="log_time">Log Time</option>
                <option value="timestamp">Timestamp</option>
                <option value="ip_address">IP Address</option>
                <option value="http_method">HTTP Method</option>
                <option value="request_url">Request URL</option>
                <option value="status_code">Status Code</option>
              </select>
              <input
                type="text"
                id="search"
                class="border-gray-700 ml-2 border p-2 text-black"
                placeholder="Search..."
              />
            </div>
            <div>
              <table
                id="logTable"
                class="bg-gray-500 border-gray-700 mt-4 w-full overflow-hidden border bg-white shadow-md"
              >
                <thead class="bg-gray-200">
                  <tr>
                    <th class="border-b py-2 px-4 text-left">Log ID</th>
                    <th class="border-b py-2 px-4 text-left">Log Time</th>
                    <th class="border-b py-2 px-4 text-left">Timestamp</th>
                    <th class="border-b py-2 px-4 text-left">IP Address</th>
                    <th class="border-b py-2 px-4 text-left">HTTP Method</th>
                    <th class="border-b py-2 px-4 text-left">Request URL</th>
                    <th class="border-b py-2 px-4 text-left">Status Code</th>
                  </tr>
                </thead>
                <tbody class="bg-gray-700" id="logTableBody">
                  <!-- Data will be populated here dynamically using JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
          <div
            x-data="{ items: [], addItem: function() { this.items.push('New Item ' + (this.items.length + 1)); } }"
            x-init="() => {
              Alpine.plugin(window.persist)
              Alpine.persist('items')
            }"
          >
            <!-- Display the list -->
            <ul>
              <template x-for="item in items" :key="item">
                <li x-text="item"></li>
              </template>
            </ul>

            <!-- Button to add items -->
            <button x-on:click="addItem">Add Item</button>
          </div>
        </main>
        <!-- ===== Main Content End ===== -->
      </div>
      <!-- ===== Content Area End ===== -->
    </div>
    <!-- ===== Page Wrapper End ===== -->

    <script src="./js/components/liveDashboard.js"></script>
    <script src="./js/components/logTableScript.js"></script>
    <script>
      function fetchData() {
        return new Promise((resolve) => {
          setTimeout(() => {
            resolve([
              { id: 1, name: "Item 1" },
              { id: 2, name: "Item 2" },
            ]);
          }, 1000);
        });
      }

      // Update Alpine.js state with fetched data
      document.addEventListener("DOMContentLoaded", async function () {
        const app = document.querySelector("[x-data]");

        if (app) {
          const fetchedData = await fetchData();
          Alpine.data(app, "items", () => fetchedData);
        }
      });
    </script>
  </body>
</html>
